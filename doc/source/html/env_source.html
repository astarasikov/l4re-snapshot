<html>
  <head>
    <title>L4Re Reference Manual</title>      
    <link href="doxygen.css" rel="stylesheet" type="text/css">
    <link href="tabs.css" rel="stylesheet" type="text/css">
  </HEAD>

  <body style="background: #fff url(header-bg.png) repeat-x scroll 0 0">
   <div>
    <div style="text-align: center; margin-bottom: 10px; border-width: 0 0 1px 0; border-color: #000; border-style: solid">
    L4Re - L4 Runtime Environment
    </div>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>l4/re/env</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++ -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vim:ft=cpp</span>
<a name="l00007"></a>00007 <span class="comment"></span><span class="comment">/*</span>
<a name="l00008"></a>00008 <span class="comment"> * (c) 2008-2009 Adam Lackorzynski &lt;adam@os.inf.tu-dresden.de&gt;,</span>
<a name="l00009"></a>00009 <span class="comment"> *               Alexander Warg &lt;warg@os.inf.tu-dresden.de&gt;,</span>
<a name="l00010"></a>00010 <span class="comment"> *               Björn Döbel &lt;doebel@os.inf.tu-dresden.de&gt;</span>
<a name="l00011"></a>00011 <span class="comment"> *     economic rights: Technische Universität Dresden (Germany)</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This file is part of TUD:OS and distributed under the terms of the</span>
<a name="l00014"></a>00014 <span class="comment"> * GNU General Public License 2.</span>
<a name="l00015"></a>00015 <span class="comment"> * Please see the COPYING-GPL-2 file for details.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * As a special exception, you may use this file as part of a free software</span>
<a name="l00018"></a>00018 <span class="comment"> * library without restriction.  Specifically, if other files instantiate</span>
<a name="l00019"></a>00019 <span class="comment"> * templates or use macros or inline functions from this file, or you compile</span>
<a name="l00020"></a>00020 <span class="comment"> * this file and link it with other files to produce an executable, this</span>
<a name="l00021"></a>00021 <span class="comment"> * file does not by itself cause the resulting executable to be covered by</span>
<a name="l00022"></a>00022 <span class="comment"> * the GNU General Public License.  This exception does not however</span>
<a name="l00023"></a>00023 <span class="comment"> * invalidate any other reasons why the executable file might be covered by</span>
<a name="l00024"></a>00024 <span class="comment"> * the GNU General Public License.</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 <span class="preprocessor">#pragma once</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;l4/sys/types.h&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;l4/re/rm&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;l4/re/parent&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;l4/re/mem_alloc&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;l4/re/log&gt;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;l4/re/env.h&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>L4 {
<a name="l00038"></a>00038 <span class="keyword">class </span>Scheduler;
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00044"></a>00044 <span class="keyword">namespace </span>L4Re
<a name="l00045"></a>00045 {
<a name="l00085"></a><a class="code" href="classL4Re_1_1Env.html">00085</a>   <span class="keyword">class </span><a class="code" href="group__l4sys__defines.html#ga63e7f1ab50a1b3049bdd0a34e97423c2" title="Attribute to mark functions, variables, and data types as being exported from a library.">L4_EXPORT</a> <a class="code" href="classL4Re_1_1Env.html" title="Initial Environment (C++ version).">Env</a>
<a name="l00086"></a>00086   {
<a name="l00087"></a>00087   <span class="keyword">private</span>:
<a name="l00088"></a>00088     <a class="code" href="structl4re__env__t.html" title="Initial Environment structure (C version).">l4re_env_t</a> _env;
<a name="l00089"></a>00089   <span class="keyword">public</span>:
<a name="l00090"></a>00090 
<a name="l00094"></a><a class="code" href="classL4Re_1_1Env.html#a6f210542f5090254dc7c93826ce2fcc0">00094</a>     <span class="keyword">typedef</span> <a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">l4re_env_cap_entry_t</a> <a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">Cap_entry</a>;
<a name="l00095"></a>00095 
<a name="l00103"></a><a class="code" href="classL4Re_1_1Env.html#aa1181d6256037deda5b5f83c2006ba60">00103</a>     <span class="keyword">static</span> <a class="code" href="classL4Re_1_1Env.html" title="Initial Environment (C++ version).">Env</a> <span class="keyword">const</span> *env() throw()
<a name="l00104"></a>00104     { <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classL4Re_1_1Env.html" title="Initial Environment (C++ version).">Env</a>*<span class="keyword">&gt;</span>(l4re_global_env); }
<a name="l00105"></a>00105 
<a name="l00110"></a><a class="code" href="classL4Re_1_1Env.html#a65f7ede8b780bb2f5d5067672bfbd3e0">00110</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Parent&gt;</a> parent() <span class="keyword">const</span> throw()
<a name="l00111"></a>00111     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Parent&gt;</a>(_env.parent); }
<a name="l00116"></a><a class="code" href="classL4Re_1_1Env.html#a26c03d9c364bcaff23e02f87bb99ad02">00116</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Mem_alloc&gt;</a> mem_alloc() <span class="keyword">const</span> throw()
<a name="l00117"></a>00117     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Mem_alloc&gt;</a>(_env.mem_alloc); }
<a name="l00122"></a><a class="code" href="classL4Re_1_1Env.html#ab2763e0c36cbf644e2e350c7c9251187">00122</a>     <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;Rm&gt;</a> rm() <span class="keyword">const</span> throw()
<a name="l00123"></a>00123     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;Rm&gt;</a>(_env.rm); }
<a name="l00128"></a><a class="code" href="classL4Re_1_1Env.html#a5ba4094b5fd61a19d0b4b9b3a7ea0510">00128</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Log&gt;</a> log() <span class="keyword">const</span> throw()
<a name="l00129"></a>00129     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Log&gt;</a>(_env.log); }
<a name="l00134"></a><a class="code" href="classL4Re_1_1Env.html#a86a9810a4cd4046729260a7492ef25cb">00134</a>     <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Thread&gt;</a> main_thread() <span class="keyword">const</span> throw()
<a name="l00135"></a>00135     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Thread&gt;</a>(_env.main_thread); }
<a name="l00140"></a><a class="code" href="classL4Re_1_1Env.html#afd54eb87494691cdb043fd485e4c7cf1">00140</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;L4::Task&gt;</a> task() <span class="keyword">const</span> throw()
<a name="l00141"></a>00141     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;L4::Task&gt;</a>(L4_BASE_TASK_CAP); }
<a name="l00146"></a><a class="code" href="classL4Re_1_1Env.html#a7868d9036233fb39c80b3794f906095d">00146</a>     <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Factory&gt;</a> factory() <span class="keyword">const</span> throw()
<a name="l00147"></a>00147     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Factory&gt;</a>(_env.factory); }
<a name="l00154"></a><a class="code" href="classL4Re_1_1Env.html#ab6ec1f1e3d8a9af84a17f33311bb0373">00154</a>     <a class="code" href="group__l4__cap__api.html#ga1445e923ce73029130d569d6e69a4dd8" title="L4 Capability selector Type.">l4_cap_idx_t</a> first_free_cap() <span class="keyword">const</span> throw()
<a name="l00155"></a>00155     { <span class="keywordflow">return</span> _env.first_free_cap; }
<a name="l00160"></a><a class="code" href="classL4Re_1_1Env.html#a8a1d7c70f9a59c28d530877e4cccb002">00160</a>     <a class="code" href="unionl4__fpage__t.html" title="L4 flexpage type.">l4_fpage_t</a> utcb_area() <span class="keyword">const</span> throw()
<a name="l00161"></a>00161     { <span class="keywordflow">return</span> _env.utcb_area; }
<a name="l00169"></a><a class="code" href="classL4Re_1_1Env.html#a27ce469b8f602bc949c1a88b830785d5">00169</a>     <a class="code" href="group__l4__basic__types.html#ga4087b991c40c0d2fcde9ca331049a4d4" title="Address type.">l4_addr_t</a> first_free_utcb() <span class="keyword">const</span> throw()
<a name="l00170"></a>00170     { <span class="keywordflow">return</span> _env.first_free_utcb; }
<a name="l00171"></a>00171 
<a name="l00176"></a><a class="code" href="classL4Re_1_1Env.html#a8640e798d313cf8b20ef7875cde842a8">00176</a>     <a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">Cap_entry</a> <span class="keyword">const</span> *initial_caps() <span class="keyword">const</span> throw()
<a name="l00177"></a>00177     { <span class="keywordflow">return</span> _env.caps; }
<a name="l00178"></a>00178 
<a name="l00187"></a><a class="code" href="classL4Re_1_1Env.html#a4bba9f2259fc3e756427d390333ce9b9">00187</a>     <a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">Cap_entry</a> <span class="keyword">const</span> *<span class="keyword">get</span>(<span class="keywordtype">char</span> <span class="keyword">const</span> *name, <span class="keywordtype">unsigned</span> l) <span class="keyword">const</span> <span class="keywordflow">throw</span>()
<a name="l00188"></a>00188     { <span class="keywordflow">return</span> <a class="code" href="group__api__l4re__env.html#ga62915a3a43611455cd16dabc6ecb293a" title="Get the full l4re_env_cap_entry_t for the object named name.">l4re_get_env_cap_l</a>(name, l, &amp;_env); }
<a name="l00189"></a>00189 
<a name="l00198"></a>00198     <span class="keyword">template</span>&lt; <span class="keyword">typename</span> T &gt;
<a name="l00199"></a><a class="code" href="classL4Re_1_1Env.html#ae303b2084a6fc6f800c01d9836c27efb">00199</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;T&gt;</a> get_cap(<span class="keywordtype">char</span> <span class="keyword">const</span> *name, <span class="keywordtype">unsigned</span> l) <span class="keyword">const</span> <span class="keywordflow">throw</span>()
<a name="l00200"></a>00200     {
<a name="l00201"></a>00201       <span class="keywordflow">if</span> (<a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">Cap_entry</a> <span class="keyword">const</span> *e = <span class="keyword">get</span>(name, l))
<a name="l00202"></a>00202   <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;T&gt;</a>(e-&gt;cap);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204       <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;T&gt;</a>(-L4_ENOENT); <span class="comment">//L4::Cap&lt;T&gt;::Invalid;</span>
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 
<a name="l00213"></a>00213     <span class="keyword">template</span>&lt; <span class="keyword">typename</span> T &gt;
<a name="l00214"></a><a class="code" href="classL4Re_1_1Env.html#a1fb7a35006c3299e5837a0b04401f12f">00214</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;T&gt;</a> get_cap(<span class="keywordtype">char</span> <span class="keyword">const</span> *name) <span class="keyword">const</span> <span class="keywordflow">throw</span>()
<a name="l00215"></a>00215     { <span class="keywordflow">return</span> get_cap&lt;T&gt;(name, __builtin_strlen(name)); }
<a name="l00216"></a>00216 
<a name="l00221"></a><a class="code" href="classL4Re_1_1Env.html#a724e852751bb9027413463e4083b4e52">00221</a>     <span class="keywordtype">void</span> parent(<a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Parent&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00222"></a>00222     { _env.parent = c.cap(); }
<a name="l00227"></a><a class="code" href="classL4Re_1_1Env.html#a493d94d949b7e0f2b776c62f1b0d6a27">00227</a>     <span class="keywordtype">void</span> mem_alloc(<a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Mem_alloc&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00228"></a>00228     { _env.mem_alloc = c.cap(); }
<a name="l00233"></a><a class="code" href="classL4Re_1_1Env.html#ae01fb0997c4bc6c5bc220170bf2aac81">00233</a>     <span class="keywordtype">void</span> rm(<a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;Rm&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00234"></a>00234     { _env.rm = c.cap(); }
<a name="l00239"></a><a class="code" href="classL4Re_1_1Env.html#a26f864f89d43a543f807fb63fd9a131d">00239</a>     <span class="keywordtype">void</span> log(<a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;Log&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00240"></a>00240     { _env.log = c.cap(); }
<a name="l00245"></a><a class="code" href="classL4Re_1_1Env.html#a3ebe33241c4026795a13b693e156fa11">00245</a>     <span class="keywordtype">void</span> main_thread(<a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Thread&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00246"></a>00246     { _env.main_thread = c.cap(); }
<a name="l00251"></a><a class="code" href="classL4Re_1_1Env.html#adb6a54c71633b6602d50b994f5202e23">00251</a>     <span class="keywordtype">void</span> factory(<a class="code" href="classL4_1_1Cap.html">L4::Cap&lt;L4::Factory&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00252"></a>00252     { _env.factory = c.cap(); }
<a name="l00257"></a><a class="code" href="classL4Re_1_1Env.html#a682ef21fccf362befdbe6b50462ba867">00257</a>     <span class="keywordtype">void</span> first_free_cap(<a class="code" href="group__l4__cap__api.html#ga1445e923ce73029130d569d6e69a4dd8" title="L4 Capability selector Type.">l4_cap_idx_t</a> c) <span class="keywordflow">throw</span>()
<a name="l00258"></a>00258     { _env.first_free_cap = c; }
<a name="l00263"></a><a class="code" href="classL4Re_1_1Env.html#a87539cf2d653d94b2faa3b1ff8b5368c">00263</a>     <span class="keywordtype">void</span> utcb_area(<a class="code" href="unionl4__fpage__t.html" title="L4 flexpage type.">l4_fpage_t</a> utcbs) <span class="keywordflow">throw</span>()
<a name="l00264"></a>00264     { _env.utcb_area = utcbs; }
<a name="l00269"></a><a class="code" href="classL4Re_1_1Env.html#aa37263704207df3fa9574f46e46d742b">00269</a>     <span class="keywordtype">void</span> first_free_utcb(<a class="code" href="group__l4__basic__types.html#ga4087b991c40c0d2fcde9ca331049a4d4" title="Address type.">l4_addr_t</a> u) <span class="keywordflow">throw</span>()
<a name="l00270"></a>00270     { _env.first_free_utcb = u; }
<a name="l00271"></a>00271 
<a name="l00277"></a><a class="code" href="classL4Re_1_1Env.html#a6bf12d62cdb84aba97de08707767026f">00277</a>     <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;L4::Scheduler&gt;</a> scheduler() <span class="keyword">const</span> throw()
<a name="l00278"></a>00278     { <span class="keywordflow">return</span> <a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;L4::Scheduler&gt;</a>(_env.scheduler); }
<a name="l00279"></a>00279 
<a name="l00284"></a><a class="code" href="classL4Re_1_1Env.html#ab23ac895f1fcca424b7277a3c4874f36">00284</a>     <span class="keywordtype">void</span> scheduler(<a class="code" href="classL4_1_1Cap.html" title="Capability Selector a la C++.">L4::Cap&lt;L4::Scheduler&gt;</a> <span class="keyword">const</span> &amp;c) <span class="keywordflow">throw</span>()
<a name="l00285"></a>00285     { _env.scheduler = c.cap(); }
<a name="l00286"></a>00286 
<a name="l00292"></a><a class="code" href="classL4Re_1_1Env.html#afed90217065bb21732d33dd65ecc2b9a">00292</a>     <span class="keywordtype">void</span> initial_caps(<a class="code" href="structl4re__env__cap__entry__t.html" title="Entry in the L4Re environment array for the named inital objects.">Cap_entry</a> *first) <span class="keywordflow">throw</span>()
<a name="l00293"></a>00293     { _env.caps = first; }
<a name="l00294"></a>00294   };
<a name="l00295"></a>00295 };
</pre></div></div>
</div>
    <div style="background-color: #fff; border-width: 1px 0 0 0; border-color: #000; border-style: solid; text-align: center; margin-top: 10px">
    L4Re - L4 Runtime Environment
    </div>
   </div>
  </body>
</html>
